# 网络视频服务系统任意文件读取漏洞检测工具

## 工具介绍
本工具用于检测网络视频服务系统是否存在任意文件读取漏洞。该漏洞通过特定的URL路径构造，可读取服务器上的敏感文件（如`/etc/passwd`），工具通过发送检测请求并验证响应内容来判断目标是否存在漏洞。

## 漏洞原理
漏洞存在于目标系统的`/download.action`接口，通过构造包含路径穿越的参数（`filename=../../../../../../../../etc/passwd`），可读取服务器上的`/etc/passwd`文件。工具通过检测响应中是否包含`root:x:0:0:root:/root:/bin/bash`特征字符串来判断漏洞是否存在。

## 环境要求
- Python 3.x
- 所需依赖库：
  - requests
  - multiprocessing（Python标准库，无需额外安装）
  - argparse（Python标准库，无需额外安装）

可通过以下命令安装依赖：
```bash
pip install requests
```

## 使用方法

### 命令参数说明
| 参数 | 简写 | 说明 | 示例 |
|------|------|------|------|
| --url | -u | 单个目标URL检测 | `-u http://example.com` |
| --file | -f | 从文件中读取多个目标URL进行批量检测 | `-f urls.txt` |
| --help | -h | 查看帮助信息 | `-h` |

### 单个目标检测
```bash
python exploit.py -u http://target-url
```

### 批量目标检测
1. 准备包含目标URL的文件（每行一个URL），例如`urls.txt`
2. 执行批量检测命令：
```bash
python exploit.py -f urls.txt
```

## 输出说明
- `[+] http://target-url 存在任意读取漏洞`：目标存在漏洞，会同时记录到`result1.txt`文件中
- `[-] 该http://target-url 不存在任意读取漏洞`：目标不存在漏洞
- `[*] 该http://target-url 存在问题,请手工测试`：目标响应状态码非200，需要手工验证

## 注意事项
1. 工具运行时会禁用SSL证书验证警告（因部分目标可能使用自签名证书）
2. 批量检测默认使用50个进程，可根据实际网络环境在代码中调整`Pool(50)`的数值
3. 检测结果会保存在当前目录下的`result1.txt`文件中
4. 使用本工具需遵守相关法律法规，仅可对授权目标进行检测
5. 网络不稳定可能导致部分目标检测结果不准确，建议对标记为"需要手工测试"的目标进行二次验证

## 免责声明
本工具仅用于安全测试和学习研究，请勿用于未授权的渗透测试。使用本工具造成的任何违法违规行为，均由使用者自行承担责任。
