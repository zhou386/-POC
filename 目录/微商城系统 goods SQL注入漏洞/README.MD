# 微商城系统 goods.php SQL 注入漏洞 POC 工具

## 工具简介
本工具用于检测 **微商城系统** 中 `goods.php` 页面的 `id` 参数是否存在 SQL 注入漏洞。通过构造包含 `UNION ALL SELECT` 的恶意请求，结合 `md5(1)` 特征值验证，快速识别目标是否存在漏洞，支持单 URL 检测与批量 URL 检测。


## 漏洞原理
微商城系统的 `goods.php` 页面未对 `id` 参数进行严格过滤，攻击者可通过构造带 SQL 语句的参数（如 `' UNION ALL SELECT ...`）篡改原有查询逻辑。  
本工具核心检测逻辑：
1. 向目标发送基础请求，确认服务可正常访问（状态码 200）；
2. 构造注入 payload：`/goods.php?id=%27+UNION+ALL+SELECT+NULL,NULL,NULL,md5(1),NULL,...--+-`（其中 `md5(1)` 结果为 `c4ca4238a0b923820dcc509a6f75849b`）；
3. 若响应内容中包含 `md5(1)` 的特征值，则判定目标存在 SQL 注入漏洞。


## 环境依赖
仅需 Python 3.x 及以下依赖库，执行命令安装：
```bash
pip install requests
```


## 工具使用
### 1. 命令行参数说明
| 参数        | 简写 | 作用                  | 示例                          |
|-------------|------|-----------------------|-------------------------------|
| `--url`     | `-u` | 单目标 URL 检测        | `-u http://192.168.1.100`     |
| `--file`    | `-f` | 批量检测（URL 列表文件）| `-f url_list.txt`             |
| `--help`    | `-h` | 查看帮助信息          | `-h`                          |


### 2. 基础使用场景
#### 场景 1：单目标检测
检测单个微商城系统是否存在漏洞：
```bash
python goods_sql_inject_poc.py -u http://192.168.1.100/mall
```

#### 场景 2：批量目标检测
1. 准备 URL 列表文件（如 `url_list.txt`），每行一个目标（支持带路径、不带协议头）：
   ```txt
   http://192.168.1.100
   https://mall.example.com
   192.168.1.101:8080/mall
   ```
2. 执行批量检测（默认 50 线程，可修改 `Pool(50)` 调整）：
   ```bash
   python goods_sql_inject_poc.py -f url_list.txt
   ```


### 3. 输出说明
| 输出标识 | 含义                                  |
|----------|---------------------------------------|
| `[+]`    | 目标存在 SQL 注入漏洞，结果已存 `result1.txt` |
| `[-]`    | 目标不存在该漏洞                      |
| `[*]`    | 目标访问异常（如状态码非 200），需手工验证 |


## 注意事项
1. **合法性声明**：  
   本工具仅用于 **合法授权的安全测试**（如企业内部资产自查），禁止用于未授权攻击，滥用后果自负。
2. **网络影响**：  
   批量检测时，避免线程数过高（如超过 100），防止目标服务器拒绝服务或本地 IP 被封禁。
3. **漏洞局限性**：  
   若目标有 WAF（防火墙），可能拦截 payload，导致检测结果不准，需结合手工测试进一步验证。


## 免责声明
本工具仅用于网络安全技术研究与学习，旨在帮助修复漏洞。任何未授权使用导致的违法违规行为，均由使用者自行承担，开发者不承担任何责任。
