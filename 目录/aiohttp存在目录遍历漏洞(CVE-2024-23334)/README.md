# CVE-2024-23334 漏洞检测工具

## 工具介绍
本工具用于检测目标系统是否存在 aiohttp 目录遍历漏洞（CVE-2024-23334）。该漏洞允许攻击者通过构造特殊的 URL 路径，读取服务器上的敏感文件（如 `/etc/passwd`），从而获取系统信息并可能进一步发起攻击。


## 漏洞原理
aiohttp 是 Python 中一款常用的异步 HTTP 框架。在特定版本中，由于对静态文件路径处理不当，攻击者可通过目录穿越 payload（如 `../../../../`）绕过路径限制，访问服务器上的任意文件。本工具通过发送包含漏洞利用 payload 的请求，检测目标是否返回敏感文件内容（如 `/etc/passwd` 中的 `root:x:0:0:root:/root:/bin/bash` 特征），从而判断漏洞是否存在。


## 环境要求
- Python 3.x
- 依赖库：`requests`
- 安装依赖：
  ```bash
  pip install requests
  ```


## 使用方法
### 命令参数说明
- `-u/--url`：指定单个目标 URL 进行检测（如 `http://example.com`）
- `-f/--file`：指定包含多个目标 URL 的文件路径（每行一个 URL）
- `-h/--help`：查看帮助信息

### 示例
1. **检测单个目标**：
   ```bash
   python exploit.py -u http://example.com
   ```

2. **批量检测多个目标**（从文件读取）：
   ```bash
   python exploit.py -f urls.txt
   ```
   （`urls.txt` 格式示例：每行一个 URL，支持 `http://` 或 `https://` 前缀，若未指定前缀则默认补全 `http://`）


## 检测结果说明
- `[+] http://example.com 存在任意读取漏洞`：目标存在漏洞，已记录到 `result1.txt` 文件中
- `[-] 该 http://example.com 不存在任意读取漏洞`：目标未检测到漏洞
- `[*] 该 http://example.com 存在问题,请手工测试`：目标响应异常（非 200 状态码），建议手动验证


## 注意事项
1. 本工具仅用于合法授权的安全测试，禁止未授权使用
2. 检测过程中可能会产生网络请求，请勿对无关目标进行扫描
3. 部分目标可能存在 WAF 拦截，导致检测结果不准确，建议结合手工验证
4. 结果文件 `result1.txt` 会自动保存所有存在漏洞的目标 URL


## 免责声明
使用本工具即表示您同意：仅在获得合法授权的系统上进行测试，对使用本工具造成的任何直接或间接损失，作者不承担任何责任。
