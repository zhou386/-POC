# FastAdmin lang接口任意文件读取漏洞检测工具

## 工具介绍
本工具用于检测FastAdmin开发框架中lang接口存在的任意文件读取漏洞。该漏洞源于框架对用户输入的`lang`参数过滤不严格，攻击者可通过构造特定请求路径，读取服务器上的敏感文件（如数据库配置文件等）。

## 漏洞原理
FastAdmin框架的`/index/ajax/lang`接口在处理`lang`参数时，未对其进行充分的安全校验，允许包含`../`等路径遍历字符。通过构造`lang=../../application/database`这样的参数，可读取到应用的数据库配置文件（通常包含数据库地址、账号、密码等敏感信息）。工具通过检测该路径下是否返回包含`mysql`关键字的内容（数据库配置文件常见特征），来判断目标是否存在漏洞。

## 使用环境
- Python 3.x
- 依赖库：`requests`

可通过以下命令安装依赖：
```bash
pip install requests
```

## 使用方法
### 命令行参数说明
| 参数 | 全称 | 作用 | 示例 |
|------|------|------|------|
| `-u` | `--url` | 检测单个目标URL | `-u http://example.com` |
| `-f` | `--file` | 从文件中读取多个目标URL进行批量检测 | `-f urls.txt` |
| `-h` | `--help` | 查看帮助信息 | `-h` |

### 单个目标检测
```bash
python poc.py -u http://example.com
```

### 批量目标检测
1. 准备包含目标URL的文件（每行一个URL，支持不带协议头的域名/IP，工具会自动补全`http://`），例如`urls.txt`：
   ```
   example1.com
   http://example2.com
   192.168.1.100
   ```
2. 执行批量检测命令：
   ```bash
   python poc.py -f urls.txt
   ```

## 检测结果说明
- `[+] http://example.com 存在任意文件读取漏洞`：目标存在漏洞，工具会将该URL写入`result.txt`文件中
- `[-] 该http://example.com 不存在任意文件读取漏洞`：目标不存在漏洞
- `[*] 该http://example.com 存在问题,请手工测试`：目标访问异常（如状态码非200），建议手工验证

## 注意事项
1. 本工具仅用于合法的安全测试和漏洞验证，使用前请确保已获得目标系统的授权，禁止未授权测试。
2. 批量检测时，工具默认使用50个进程并发请求，可根据网络环境在代码中调整`Pool(50)`的数值。
3. 检测结果会保存在当前目录下的`result.txt`文件中，重复运行会追加内容。

## 免责声明
本工具仅用于安全研究和合法授权的渗透测试，请勿用于未授权的攻击行为。使用本工具造成的任何违法违规后果，由使用者自行承担，与工具开发者无关。
