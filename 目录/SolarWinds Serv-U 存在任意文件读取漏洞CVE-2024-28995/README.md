# SolarWinds Serv-U 任意文件读取漏洞检测工具（CVE-2024-28995）

## 工具介绍
本工具用于检测SolarWinds Serv-U产品中存在的任意文件读取漏洞（CVE-2024-28995）。该漏洞源于Serv-U对特定接口的参数校验不严格，攻击者可通过构造恶意请求读取服务器上的敏感文件（如`/etc/passwd`等系统文件），从而获取敏感信息并进一步渗透。

## 漏洞原理
SolarWinds Serv-U的特定接口在处理`InternalDir`和`InternalFile`参数时存在路径遍历缺陷，允许攻击者通过传入包含`../`（或Windows环境下的`..\`）的路径构造，绕过文件访问限制。本工具通过发送包含`/?InternalDir=\..\..\..\..\etc&InternalFile=passwd`的恶意请求，检测目标是否返回包含`root`关键字的内容（`/etc/passwd`文件的典型特征），以此判断漏洞是否存在。

## 环境要求
- Python 3.x
- 依赖库：`requests`

可通过以下命令安装依赖：
```bash
pip install requests
```

## 使用方法
### 命令行参数说明
| 参数 | 全称 | 作用 | 示例 |
|------|------|------|------|
| `-u` | `--url` | 检测单个目标URL | `-u http://192.168.1.100` |
| `-f` | `--file` | 从文件中读取多个目标URL进行批量检测 | `-f targets.txt` |
| `-h` | `--help` | 查看帮助信息 | `-h` |

### 单个目标检测
执行以下命令检测单个目标是否存在漏洞：
```bash
python servu_poc.py -u http://target-ip:port
```

### 批量目标检测
1. 准备包含目标URL的文件（每行一个目标，支持不带协议头的IP/域名，工具会自动补全`http://`），例如`targets.txt`：
   ```
   192.168.1.100
   https://servu.example.com
   10.0.0.5:8080
   ```
2. 执行批量检测命令：
   ```bash
   python servu_poc.py -f targets.txt
   ```

## 检测结果说明
- `[+] http://target 存在任意文件读取`：目标存在CVE-2024-28995漏洞，工具会将该目标写入`result.txt`文件
- `[-] http://target 不存在任意文件读取`：目标未检测到漏洞
- `[*] http://target 访问有问题，请手工访问`：目标访问异常（如状态码非200），建议手动验证

## 工具特性
- 支持随机User-Agent头，降低检测请求被拦截的概率
- 批量检测时使用50个进程并发请求，提高检测效率（可在代码中修改`Pool(50)`调整并发数）
- 自动忽略SSL证书验证警告，适配HTTPS目标
- 检测结果自动写入`result.txt`文件，便于后续分析

## 注意事项
1. 本工具仅用于合法的安全测试和漏洞验证，使用前必须获得目标系统的书面授权，禁止未授权测试。
2. 批量检测时请合理控制并发数，避免对目标服务器造成过载影响。
3. 部分目标可能存在WAF/IPS拦截，导致检测结果不准确，建议对可疑目标进行手工验证。
4. 漏洞利用可能涉及敏感文件读取，需严格遵守相关法律法规。

## 免责声明
本工具的开发和使用旨在提升网络安全防护能力，仅限授权环境下使用。因未授权使用本工具造成的任何违法违规后果，由使用者自行承担，与工具开发者无关。
